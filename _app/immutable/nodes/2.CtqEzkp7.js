import{S as oe,i as ce,s as ie,n as ee,d as w,b as j,c as o,m as _,e as b,f as D,o as S,h as I,j as v,k as A,p as de,a as V,g as q,t as F,q as ue,r as ne,u as Y,v as z}from"../chunks/BKcaPgXC.js";import"../chunks/IHki7fMi.js";function te(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function le(l,e,t){const r=l.slice();return r[14]=e[t],r}function he(l){let e,t,r,n,k,i,f="Export CSV",u,m,C,U,N='<tr class="border-b"><th class="py-2 mr-3">ID</th> <th class="py-2 mr-3">Name</th> <th class="py-2 mr-3">Email</th> <th class="py-2 mr-3">Phone</th> <th class="py-2 mr-3">Address</th> <th class="py-2 mr-3">Actions</th></tr>',R,E,P,H,a;function h(s,T){if(s[2])return me;if(s[4].length===0)return pe}let x=h(l),d=x&&x(l),g=te(l[4]),c=[];for(let s=0;s<g.length;s+=1)c[s]=se(le(l,g,s));return{c(){e=v("div"),t=v("input"),r=A(),n=v("input"),k=A(),i=v("button"),i.textContent=f,u=A(),m=v("div"),C=v("table"),U=v("thead"),U.innerHTML=N,R=A(),E=v("tbody"),d&&d.c(),P=A();for(let s=0;s<c.length;s+=1)c[s].c();this.h()},l(s){e=b(s,"DIV",{class:!0});var T=D(e);t=b(T,"INPUT",{type:!0,placeholder:!0,class:!0}),r=I(T),n=b(T,"INPUT",{type:!0,placeholder:!0,class:!0}),k=I(T),i=b(T,"BUTTON",{class:!0,"data-svelte-h":!0}),S(i)!=="svelte-1s20gt0"&&(i.textContent=f),T.forEach(w),u=I(s),m=b(s,"DIV",{class:!0});var p=D(m);C=b(p,"TABLE",{class:!0});var L=D(C);U=b(L,"THEAD",{"data-svelte-h":!0}),S(U)!=="svelte-pzxacy"&&(U.innerHTML=N),R=I(L),E=b(L,"TBODY",{});var M=D(E);d&&d.l(M),P=I(M);for(let O=0;O<c.length;O+=1)c[O].l(M);M.forEach(w),L.forEach(w),p.forEach(w),this.h()},h(){_(t,"type","text"),_(t,"placeholder","Search..."),_(t,"class","w-full p-2 rounded border border-gray-300"),_(n,"type","text"),_(n,"placeholder","Filter by name..."),_(n,"class","w-1/3 p-2 rounded border border-gray-300"),_(i,"class","p-2 bg-blue-500 text-white rounded"),_(e,"class","w-full max-w-3xl flex gap-3 mb-6"),_(C,"class","w-full text-left"),_(m,"class","w-full max-w-3xl bg-white shadow rounded p-4")},m(s,T){j(s,e,T),o(e,t),Y(t,l[0]),o(e,r),o(e,n),Y(n,l[1]),o(e,k),o(e,i),j(s,u,T),j(s,m,T),o(m,C),o(C,U),o(C,R),o(C,E),d&&d.m(E,null),o(E,P);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(E,null);H||(a=[z(t,"input",l[9]),z(n,"input",l[10]),z(i,"click",l[7])],H=!0)},p(s,T){if(T&1&&t.value!==s[0]&&Y(t,s[0]),T&2&&n.value!==s[1]&&Y(n,s[1]),x!==(x=h(s))&&(d&&d.d(1),d=x&&x(s),d&&(d.c(),d.m(E,P))),T&112){g=te(s[4]);let p;for(p=0;p<g.length;p+=1){const L=le(s,g,p);c[p]?c[p].p(L,T):(c[p]=se(L),c[p].c(),c[p].m(E,null))}for(;p<c.length;p+=1)c[p].d(1);c.length=g.length}},d(s){s&&(w(e),w(u),w(m)),d&&d.d(),ue(c,s),H=!1,ne(a)}}}function fe(l){let e,t;return{c(){e=v("div"),t=F(l[3]),this.h()},l(r){e=b(r,"DIV",{class:!0});var n=D(e);t=q(n,l[3]),n.forEach(w),this.h()},h(){_(e,"class","w-full max-w-3xl text-center text-red-600 font-semibold py-10")},m(r,n){j(r,e,n),o(e,t)},p(r,n){n&8&&V(t,r[3])},d(r){r&&w(e)}}}function pe(l){let e,t='<td colspan="6" class="py-3 text-center text-gray-500">No results found</td>';return{c(){e=v("tr"),e.innerHTML=t},l(r){e=b(r,"TR",{"data-svelte-h":!0}),S(e)!=="svelte-joomy3"&&(e.innerHTML=t)},m(r,n){j(r,e,n)},d(r){r&&w(e)}}}function me(l){let e,t='<td colspan="6" class="py-3 text-center text-gray-500">Loading...</td>';return{c(){e=v("tr"),e.innerHTML=t},l(r){e=b(r,"TR",{"data-svelte-h":!0}),S(e)!=="svelte-1flwllq"&&(e.innerHTML=t)},m(r,n){j(r,e,n)},d(r){r&&w(e)}}}function se(l){let e,t,r=l[14].id+"",n,k,i,f=l[14].name+"",u,m,C,U=l[14].email+"",N,R,E,P=l[14].phone+"",H,a,h,x=l[14].address+"",d,g,c,s,T="Edit",p,L,M="Delete",O,G,K;function re(){return l[11](l[14])}function ae(){return l[12](l[14])}return{c(){e=v("tr"),t=v("td"),n=F(r),k=A(),i=v("td"),u=F(f),m=A(),C=v("td"),N=F(U),R=A(),E=v("td"),H=F(P),a=A(),h=v("td"),d=F(x),g=A(),c=v("td"),s=v("button"),s.textContent=T,p=A(),L=v("button"),L.textContent=M,O=A(),this.h()},l(B){e=b(B,"TR",{class:!0});var y=D(e);t=b(y,"TD",{class:!0});var Q=D(t);n=q(Q,r),Q.forEach(w),k=I(y),i=b(y,"TD",{class:!0});var W=D(i);u=q(W,f),W.forEach(w),m=I(y),C=b(y,"TD",{class:!0});var X=D(C);N=q(X,U),X.forEach(w),R=I(y),E=b(y,"TD",{class:!0});var Z=D(E);H=q(Z,P),Z.forEach(w),a=I(y),h=b(y,"TD",{class:!0});var $=D(h);d=q($,x),$.forEach(w),g=I(y),c=b(y,"TD",{class:!0});var J=D(c);s=b(J,"BUTTON",{class:!0,"data-svelte-h":!0}),S(s)!=="svelte-tmtxkl"&&(s.textContent=T),p=I(J),L=b(J,"BUTTON",{class:!0,"data-svelte-h":!0}),S(L)!=="svelte-7hz3g8"&&(L.textContent=M),J.forEach(w),O=I(y),y.forEach(w),this.h()},h(){_(t,"class","py-2 mr-3"),_(i,"class","py-2 mr-3"),_(C,"class","py-2 mr-3"),_(E,"class","py-2 mr-3"),_(h,"class","py-2 mr-3"),_(s,"class","text-blue-500"),_(L,"class","text-red-500"),_(c,"class","py-2 flex gap-2"),_(e,"class","border-b hover:bg-gray-50 transition")},m(B,y){j(B,e,y),o(e,t),o(t,n),o(e,k),o(e,i),o(i,u),o(e,m),o(e,C),o(C,N),o(e,R),o(e,E),o(E,H),o(e,a),o(e,h),o(h,d),o(e,g),o(e,c),o(c,s),o(c,p),o(c,L),o(e,O),G||(K=[z(s,"click",re),z(L,"click",ae)],G=!0)},p(B,y){l=B,y&16&&r!==(r=l[14].id+"")&&V(n,r),y&16&&f!==(f=l[14].name+"")&&V(u,f),y&16&&U!==(U=l[14].email+"")&&V(N,U),y&16&&P!==(P=l[14].phone+"")&&V(H,P),y&16&&x!==(x=l[14].address+"")&&V(d,x)},d(B){B&&w(e),G=!1,ne(K)}}}function _e(l){let e,t,r="User Records (API Connected)",n;function k(u,m){return u[3]?fe:he}let i=k(l),f=i(l);return{c(){e=v("div"),t=v("h1"),t.textContent=r,n=A(),f.c(),this.h()},l(u){e=b(u,"DIV",{class:!0});var m=D(e);t=b(m,"H1",{class:!0,"data-svelte-h":!0}),S(t)!=="svelte-15s3x71"&&(t.textContent=r),n=I(m),f.l(m),m.forEach(w),this.h()},h(){_(t,"class","text-2xl font-semibold mb-4"),_(e,"class","min-h-screen bg-gray-100 flex flex-col items-center p-6")},m(u,m){j(u,e,m),o(e,t),o(e,n),f.m(e,null)},p(u,[m]){i===(i=k(u))&&f?f.p(u,m):(f.d(1),f=i(u),f&&(f.c(),f.m(e,null)))},i:ee,o:ee,d(u){u&&w(e),f.d()}}}function be(l,e,t){let r,n=[],k="",i="",f=!0,u=null;de(async()=>{await m()});async function m(){t(2,f=!0),t(3,u=null);//! gets data from MySQL
try{const a=await fetch("http://localhost/APIs/api.php");if(!a.ok)throw new Error(`API Error: ${a.status} ${a.statusText}`);const h=await a.json();t(8,n=h)}catch(a){console.error("Failed to load users",a),t(3,u=a.message)}finally{t(2,f=!1)}}//! deletes data from MySQL
async function C(a){if(confirm("Are you sure you want to delete this user?"))try{await fetch(`http://localhost/APIs/api.php/${a}`,{method:"DELETE"}),t(8,n=n.filter(h=>h.id!==a))}catch(h){console.error("Delete failed",h),alert("Failed to delete user")}}//! Updates data in MySQL
async function U(a){const h=prompt("Enter new name",a.name),x=prompt("Enter new email",a.email),d=prompt("Enter new phone",a.phone),g=prompt("Enter new address",a.address);if(!h||!x||!d||!g)return;const c={...a,name:h,email:x,phone:d,address:g};try{await fetch(`http://localhost/APIs/api.php/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),t(8,n=n.map(s=>s.id===a.id?c:s))}catch(s){console.error("Update failed",s),alert("User updated!")}}function N(){const a=["id,name,email,phone,address",...n.map(g=>`${g.id},${g.name},${g.email},${g.phone},${g.address}`)].join(`
`),h=new Blob([a],{type:"text/csv"}),x=URL.createObjectURL(h),d=document.createElement("a");d.href=x,d.download="users.csv",d.click(),URL.revokeObjectURL(x)}function R(){k=this.value,t(0,k)}function E(){i=this.value,t(1,i)}const P=a=>U(a),H=a=>C(a.id);return l.$$.update=()=>{l.$$.dirty&259&&t(4,r=n.filter(a=>{const h=k.toLowerCase();return(!i||a.name.toLowerCase().includes(i.toLowerCase()))&&(a.name.toLowerCase().includes(h)||a.email.toLowerCase().includes(h)||a.phone.toLowerCase().includes(h)||a.address.toLowerCase().includes(h))}))},[k,i,f,u,r,C,U,N,n,R,E,P,H]}class we extends oe{constructor(e){super(),ce(this,e,be,_e,ie,{})}}export{we as component};
